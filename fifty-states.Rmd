---
title: 50-State Redistricting Simulations
description: |
  Comprehensive project to simulate alternative redistricting plans for all fifty states.
date: November 11, 2021
output:
  distill::distill_article:
    self_contained: false
repository_url: https://github.com/alarm-redist/fifty-states/
doi: "10.7910/DVN/SLCD3E"
citation: true
---

```{r include=F}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
library(tidyverse)
library(ggiraph)
library(sf)
library(here)
```

```{css echo=FALSE}
div.girafe { margin-bottom: 0; }
.girafe_container_std svg text { pointer-events: none; }
.state-links { column-count: 3; }
@media only screen and (max-width: 600px) {
    .state-links { column-count: 2; }
}
```

[An intro blurb about the project]

[More information about the project]. 
Click on a state to learn more.

```{r include=F}
states = Sys.glob(here("_fifty-states/*_cd_2020")) %>%
    basename() %>%
    str_sub(1, 2)
```

```{r map, layout="l-body-outset", cache=TRUE, cache.extra=states}
d_appor = read_csv(here("_fifty-states/apportionment.csv"), col_types="cii")

usa = read_rds(here("_fifty-states/carto_states.rds")) %>%
    st_set_crs(NA) %>%
    rename(state=STATEAB, state_name=STATENAME) %>%
    left_join(d_appor, by="state_name") %>%
    mutate(factor = sqrt(cds/cds_2010),
           centroid = st_centroid(geometry),
           geometry = (geometry - centroid)*factor + centroid) %>%
    mutate(available = state %in% states,
           href = if_else(available, str_glue("fifty-states/{state}_cd_2020/"), "#"),
           code = if_else(available, str_glue('window.open("{href}", "_self")'), ""),
           tooltip = str_glue("<b>{state_name}</b><br />{cds} district{if_else(cds > 1, 's', '')}"))

p = ggplot(usa, aes(fill=available, data_id=state)) +
    geom_sf_interactive(aes(onclick=code, tooltip=tooltip), color=NA, size=0.0) +
    geom_sf_text(aes(label=if_else(available, state, ""), geometry=centroid), 
                 size=2.5, color="white", fontface="bold", ) +
    scale_fill_manual(values=c(`TRUE`="#925637", `FALSE`="#333333"), 
                      guide="none") +
    theme_void() +
    theme(plot.margin = margin(0, 0, 0, 0, "cm"))
girafe(ggobj=p, width_svg=9, height_svg=6, options=list(
    opts_hover(css="cursor: pointer;
                    filter: drop-shadow(2px 2px 3px #0004)"),
    opts_tooltip(css="font-family: 'Arial'; 
                 background: #fffa; 
                 border-radius: 3px; 
                 padding: 0.3em;
                 backdrop-filter: blur(6px);",
                 delay_mouseover=100,
                 delay_mouseout=100),
    opts_toolbar(saveaspng=FALSE)
    ))
```

### Analyzed States 

```{r links, results="asis"}
cat('<div class="state-links">')
filter(usa, available) %>%
    arrange(state_name) %>%
    mutate(html = str_glue('<p><a href="{href}">{state_name}</a></p>')) %>%
    pull() %>%
    cat(collapse="\n")
cat('</div><br />\n\n')
```


<center>

**Download the data: *[ALARM Project Dataverse](https://doi.org/10.7910/DVN/SLCD3E)* &raquo;**

</center>

## Data Sources and Availability {.appendix}

Unless otherwise noted, data for each state comes from the ALARM Project's
[2020 Redistricting Data Files](https://alarm-redist.github.io/posts/2021-08-10-census-2020/),
which use U.S. Census demographic data (in the public domain) and election data 
from the [Voting and Election Science Team](https://dataverse.harvard.edu/dataverse/electionscience), 
which is licensed  under a [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/) license.
In these cases, shapefiles are also taken from the U.S. Census Bureau.
The U.S. map here, scaled to reflect Congressional representations, is courtesy of <https://dkel.ec/map>.

All data is available [on our  Dataverse](https://doi.org/10.7910/DVN/SLCD3E).
Code is available [on GitHub](https://github.com/alarm-redist/fifty-states/).

